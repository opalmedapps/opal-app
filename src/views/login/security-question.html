<ons-page style="background-color:white;width:100vw;height:100vh" ng-controller="SecurityQuestionController as security">
    <ons-toolbar fixed-style>
        <div class="left">
            <ons-back-button ng-if="!security.passwordReset">{{"BACK"|translate}}</ons-back-button>
            <ons-back-button ng-if="security.passwordReset" ng-click="initNavigator.resetToPage('./views/init/init-screen.html',{animation:'none'});">{{"HOME"|translate}}</ons-back-button>
        </div>
        <div class="center">
            <div ng-if="!security.passwordReset">{{"SECURITYQUESTION"|translate}}</div>
            <div ng-if="security.passwordReset">{{"FORGOTPASSWORD_NOQUESTION"|translate}}</div>
        </div>
    </ons-toolbar>
    <network-banner></network-banner>

    <ons-row align="center" style="height:70vh;margin:0;top:0">
        <ons-col align="center" style="margin:0;top:0">

            <!-- OPAL LOGO -->
            <div align="center">
                <img src="./img/Opal_Name_Logo_Green_Transparent.png" style="max-width:300px;width:70vw;height:auto">
            </div>

            <!-- HOSPITAL SELECTOR -->
            <div ng-if="security.passwordReset" class="container">
                <hospital-selector></hospital-selector>
            </div>

            <!-- LOADING SPINNER -->
            <loading-spinning-circle ng-if="security.loading && security.isThereSelectedHospital()" loading-message="{{'LOADING'|translate}}" margintop="15vh"></loading-spinning-circle>

            <!-- SECURITY ANSWER FIELDS -->
            <div ng-if="!security.loading && !security.invalidCode && security.isThereSelectedHospital()" class="container" align="center" style="margin-top:20px">
                <form name="formPassword" novalidate>
                    <div class="form-group" align="center" style="margin-top: 20px">
                        <label name="text">{{ security.Question }} </label><br />
                        <div style="width: 100%; margin-top: 15px" class="style-4">
                            <password-input>
                                <input type="password" autocapitalize="none" autocorrect="off" autocomplete="new-password" class="text-input" name="text" ng-model="security.answer" ng-change="security.clearErrors()" placeholder="{{'ENTERANSWERPLACEHOLDER'|translate}}" />
                            </password-input>
                            <br />
                            <br />
                        </div>
                        <button class="button button--large shadow-2" ng-disabled="security.submitting || security.tooManyAttempts" style="background-color: #4CAF50; font-weight: bolder;" ng-click="security.submitAnswer(security.answer)">{{"CONTINUE"|translate}}</button>
                        <uib-alert ng-show="security.alert.type && security.alertShow" type="{{security.alert.type}}"
                            style="margin-top: 10px">
                            {{security.alert.content|translate}}
                        </uib-alert>
                    </div>
                </form>
            </div>
        </ons-col>
    </ons-row>
    <ons-modal var="errormodal" style="padding: 10px">
        <h4>{{"RESETERROR"|translate}}</h4>
        <ons-icon icon="ion-alert-circled" size="60px"></ons-icon>
        <p style="margin-top: 5%" class="unattended-message">{{"RETRYRESETMESSAGE"|translate}}</p>
        <ons-button style="margin: 5%; font-size: 22px; background-color: #4caf50" ng-click="security.goToReset()">{{"RETRY"|translate}}</ons-button>
        <ons-button style="margin: 5%; font-size: 22px;" ng-click="security.goToInit()">{{"HOME"|translate}}</ons-button>
    </ons-modal>
</ons-page>

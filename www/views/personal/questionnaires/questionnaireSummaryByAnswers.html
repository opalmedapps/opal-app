<ons-page ng-app="MUHCApp" ng-controller="questionnaireSummaryByAnswersController as vm">
    <div ng-show="loading" align="center" style="margin-top:25vh">
        <svg class="progress-circular">
            <circle class="progress-circular__primary" cx="50%" cy="50%" r="40%" fill="none" stroke-width="10%"
                    stroke-miterlimit="10"/>
        </svg>
        <p style="margin-top: 30px">{{ "LOADING" | translate }}</p>
    </div>

    <div>
        <div ng-if="loading === false">
            <!-- global section question row -->

            <div class="ons-row" align="center">
                <div class="ons-col" align="center">
                    <!-- section -->
                    <div ng-repeat="section in vm.historicalQuestionnaires.sections">
                        <ul class="list">
                            <ons-list-item class="list__item"
                                           ng-click="vm.toggleExpandSectionScore(section.section_ser_num, 'section-' + $index)"
                                           style="background-color: #E3F2FD">
                                <ons-row style="margin:0;padding:0" align="center">
                                    <ons-col align="left" style="border:1px solid white;color:white">
                                        <div id="section-{{$index}}" style="line-height: 1.8;margin-top:10px;margin-bottom:10px">
                                            <b>{{section.title}}</b>
                                            <span class="pull-right">
                                                <span ng-class="vm.expandSectinos[section.section_ser_num].expandSectionScores ? 'glyphicon glyphicon-menu-up' : 'glyphicon glyphicon-menu-down'">
                                                </span>
                                            </span>
                                        </div>
                                    </ons-col>
                                </ons-row>
                            </ons-list-item>
                        </ul>

                        <!--quesiton score summary-->
                        <div ng-if="vm.expandSectinos[section.section_ser_num].expandSectionScores === true">
                            <div ng-repeat="question in section.questions">
                                <ul class="list" style="width: 100vw;">
                                    <li class="list__item"
                                        ng-click="vm.toggleExpandQuestionScore(section.section_ser_num, question.question_ser_num, 'chart-' + $parent.$index + $index)">
                                        <ons-row style="margin:0;padding:0" align="center">
                                            <ons-col align="left" style="border:1px solid white;color:white">
                                                <div id="chart-{{$parent.$index}}{{$index}}"
                                                     style="line-height: 1.4;margin-top:10px;margin-bottom:10px">
                                                    {{question.question_label}}
                                                    <span class="pull-right">
                                                        <span
                                                                ng-class="vm.expandSectinos[section.section_ser_num].questions[question.question_ser_num].expandQuestionScores ? 'fa fa-minus' : 'fa fa-plus'">
                                                        </span>
                                                    </span>
                                                </div>
                                            </ons-col>
                                        </ons-row>
                                    </li>
                                </ul>
                                <div ng-show="vm.expandSectinos[section.section_ser_num].questions[question.question_ser_num].expandQuestionScores"
                                    class="ons-col" align="center">
                                    <div ng-init="vm.initChartOptions(question)">
                                        <hc-chart options="vm.chartOptions">
                                            Placeholder for line chart
                                        </hc-chart>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</ons-page>
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<widget android-versionCode="${BUILD_NUMBER}" ios-CFBundleVersion="${BUILD_NUMBER}" id="${APP_ID}" version="1.30.1" xmlns="http://www.w3.org/ns/widgets" xmlns:cdv="http://cordova.apache.org/ns/1.0" xmlns:android="http://schemas.android.com/apk/res/android">
    <name>${APP_NAME}</name>
    <description>
        Opal - the MUHC Oncology Patient Application for mobile phones and the web -
        is a product that has arisen from the winning project of the 2014 MUHC Q+ initiative.
        The project proposal was submitted by the Health Informatics Group (HIG)
        and was entitled “Realistic knowledge-based waiting time estimates for radiation oncology patients -
        addressing the pain of waiting”. It had as its goal the provision of waiting time estimates to
        radiation oncology patients.
    </description>
    <author email="muhc.app.mobile@gmail.com" href="https://opalmedapps.com">
        Opal Med Apps Inc.
    </author>
    <content src="index.html"/>
    <!--
        Cordova Allow List

        See: https://cordova.apache.org/docs/en/dev/guide/appdev/allowlist/#network-request-allow-list
        See: https://cordova.apache.org/docs/en/latest/guide/appdev/allowlist/#other-notes
    -->
    <!--
        Don't allow arbitrary loads.
        Add additional domain names specifically if necessary.

        See: https://developer.apple.com/documentation/bundleresources/information_property_list/nsapptransportsecurity/
    -->
    <allow-navigation href="https://www.youtube.com/*" requires-certificate-transparency="true"/>
    <allow-intent href="https://*/*"/>
    <allow-intent href="tel:*"/>
    <allow-intent href="sms:*"/>
    <allow-intent href="mailto:*"/>
    <allow-intent href="geo:*"/>
    <allow-intent href="opal:"/>
    <!-- Fix for cordova-ios 6.2.0 -->
    <preference name="scheme" value="app"/>
    <preference name="hostname" value="localhost"/>
    <!-- Fix for cordova-android 11.0.0/12.0.0 -->
    <allow-navigation href="https://app/*" requires-certificate-transparency="true"/>
    <allow-navigation href="https://localhost/*" requires-certificate-transparency="true"/>
    <!-- Splash screen settings -->
    <preference name="SplashScreenDelay" value="5000"/>
    <preference name="FadeSplashScreen" value="true"/>
    <preference name="FadeSplashScreenDuration" value="500"/>
    <!-- Required by @havesource/cordova-plugin-push -->
    <preference name="GradlePluginGoogleServicesEnabled" value="true"/>
    <preference name="GradlePluginGoogleServicesVersion" value="4.3.5"/>
    <!-- Other preferences -->
    <preference name="Orientation" value="default"/>
    <preference name="DisallowOverscroll" value="true"/>
    <preference name="ErrorUrl" value="www/views/error/error-page.html"/>
    <icon src="./res/OpalHealth_App_Apple_Icon_2.png"/>
    <platform name="android">
        <preference name="android-minSdkVersion" value="26"/>
        <preference name="AndroidPersistentFileLocation" value="Internal"/>
        <preference name="GradlePluginGoogleServicesEnabled" value="true"/>
        <preference name="GradlePluginKotlinEnabled" value="true"/>
        <preference name="GradlePluginKotlinVersion" value="1.7.10"/>
        <edit-config file="app/src/main/AndroidManifest.xml" mode="merge" target="/manifest/application">
            <!-- Security setting; should be false for pen tests and prod builds -->
            <application android:debuggable="${ANDROID_DEBUGGABLE}"/>
        </edit-config>
        <edit-config file="app/src/main/AndroidManifest.xml" mode="merge" target="/manifest/application">
            <!-- Security setting; do not set to true -->
            <application android:allowBackup="false"/>
        </edit-config>
        <edit-config file="app/src/main/AndroidManifest.xml" mode="merge" target="/manifest/application">
            <!-- Security setting; do not set to true. Note: blocks access to HTTP (non-HTTPS) links -->
            <application android:usesCleartextTraffic="false"/>
        </edit-config>
        <!-- requestLegacyExternalStorage fixes file access issues in Android 10 / API Level 29. This parameter will be ignored by API Level 30+, when your app is running on Android 11 devices -->
        <edit-config file="app/src/main/AndroidManifest.xml" mode="merge" target="/manifest/application">
            <application android:requestLegacyExternalStorage="true"/>
        </edit-config>
        <!-- Security setting: Ensure that activities, services, providers and receivers are not exported. This avoids them being exposed to other apps. -->
        <edit-config file="app/src/main/AndroidManifest.xml" target="/manifest/application/activity" mode="merge">
            <activity android:exported="false"/>
        </edit-config>
        <edit-config file="app/src/main/AndroidManifest.xml" target="/manifest/application/service" mode="merge">
            <service android:exported="false"/>
        </edit-config>
        <edit-config file="app/src/main/AndroidManifest.xml" target="/manifest/application/provider" mode="merge">
            <provider android:exported="false"/>
        </edit-config>
        <edit-config file="app/src/main/AndroidManifest.xml" target="/manifest/application/receiver" mode="merge">
            <receiver android:exported="false"/>
        </edit-config>
        <resource-file src="google-services.json" target="/app/google-services.json"/>
        <preference name="AndroidWindowSplashScreenAnimatedIcon" value="res/screen/android/Opal-splash-android-inverse-1400x1400.png"/>
        <access origin="cdvfile://*"/>
        <allow-intent href="market:*"/>
        <!--
            Fix duplicate permissions for android.permission.ACCESS_COARSE_LOCATION
            See: https://github.com/don/cordova-plugin-ble-central/issues/925
        -->
        <hook src="plugins/cordova-plugin-ble-central/stripDuplicatePermissions.js" type="after_prepare"/>
        <!-- Security: remove unwanted android permissions added by plugins -->
        <hook type="after_prepare" src="hooks/remove-unwanted-android-permissions.js"/>
        <!-- Security: remove unwanted android exports added by plugins -->
        <hook type="after_prepare" src="hooks/remove-unwanted-android-exports.js"/>
    </platform>
    <platform name="ios">
        <!-- Required to access location data since iOS 10 -->
        <config-file target="*-Info.plist" parent="NSLocationWhenInUseUsageDescription">
            <string>Localisation nécessaire pour l'enregistrement aux rendez-vous / Location needed for appointment check-in</string>
        </config-file>
        <!-- Required by App Store -->
        <config-file target="*-Info.plist" parent="NSLocationAlwaysAndWhenInUseUsageDescription">
            <string>Localisation nécessaire pour l'enregistrement aux rendez-vous / Location needed for appointment check-in</string>
        </config-file>
        <preference name="deployment-target" value="11.0"/>
        <preference name="WKWebViewOnly" value="true"/>
        <splash src="res/screen/ios/Default@2x~universal~anyany.png"/>
        <allow-intent href="itms:*"/>
        <allow-intent href="itms-apps:*"/>
        <icon height="180" src="res/ios/Icon-60@3x.png" width="180"/>
        <icon height="60" src="res/ios/Icon-60.png" width="60"/>
        <icon height="120" src="res/ios/Icon-60@2x.png" width="120"/>
        <icon height="76" src="res/ios/Icon-76.png" width="76"/>
        <icon height="152" src="res/ios/Icon-76@2x.png" width="152"/>
        <icon height="40" src="res/ios/Icon-40.png" width="40"/>
        <icon height="80" src="res/ios/Icon-40@2x.png" width="80"/>
        <icon height="57" src="res/ios/Icon.png" width="57"/>
        <icon height="114" src="res/ios/Icon@2x.png" width="114"/>
        <icon height="72" src="res/ios/Icon-72.png" width="72"/>
        <icon height="144" src="res/ios/Icon-72@2x.png" width="144"/>
        <icon height="29" src="res/ios/Icon-small.png" width="29"/>
        <icon height="58" src="res/ios/Icon-small@2x.png" width="58"/>
        <icon height="167" src="res/ios/Icon-167.png" width="167"/>
    </platform>
</widget>